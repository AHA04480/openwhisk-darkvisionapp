<!--
// Licensed under the Apache License. See footer for details.
-->
<div class="container" ng-controller="VideoController as controller">

  <ol class="breadcrumb">
    <li><a ui-sref="videos">Videos</a></li>
    <li class="active">{{controller.data.video.title}}</li>
  </ol>

  <h2>
    Summary <span class="small text-muted" ng-if="!controller.data.summary.image_keywords">Loading...</span>
    <p class="pull-right">
      <button class="btn btn-danger" ng-click="controller.resetImages()">Reset all images</button>
      <button class="btn btn-danger" ng-click="controller.reset()">Relaunch analysis</button>
    </p>
  </h2>

  <div class="well">
    <div class="row">
      <div class="col-md-4">
        <img class="video-thumbnail" ng-src="/images/thumbnail/{{controller.data.video._id}}.jpg" />
      </div>

      <div class="col-md-4">
        <div class="entry-tags">
          <h4>Image Keywords</h4>
          <ul class="entry-taglist">
            <li ng-repeat="keyword in controller.data.summary.image_keywords" class="entry-tag">
              <span class="label label-info">{{keyword.occurrences[0].class}} {{keyword.occurrences[0].score | formatPercent}}%</span>
            </li>
          </ul>
        </div>
      </div>

      <div class="col-md-4">
        <div class="entry-faces">
          <h4>Face Detection</h4>
          <span ng-if="controller.data.summary.face_detection.length == 0">No known face detected</span>
          <ul class="entry-taglist">
            <li ng-repeat="face in controller.data.summary.face_detection" class="entry-tag">
              <span class="face-overlay-text">{{$index+1}}</span>
              <span ng-if="face.occurrences[0].identity" class="label label-info">{{face.occurrences[0].identity.name}} {{face.occurrences[0].identity.score | formatPercent}}%</span>
              <span ng-if="face.occurrences[0].identity">&nbsp;</span>
              <span class="label label-info">{{face.occurrences[0].gender.gender}} {{face.occurrences[0].age.min}}-{{face.occurrences[0].age.max}} {{face.occurrences[0].age.score | formatPercent}}%</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-4">
      <div ng-if="controller.data.summary.audio.analysis.entities">
        <h2>Entities</h2>
        <div class="well">
          <ul class="entry-taglist">
            <li ng-repeat="entity in controller.data.summary.audio.analysis.entities" class="entry-tag">
              <span ng-if="entity.disambiguated.dbpedia" class="label label-info"><a href="{{entity.disambiguated.dbpedia}}">{{entity.text}} ({{entity.type}}) {{entity.relevance | formatPercent}}% <i class="fa fa-external-link"></i></a></span>
              <span ng-if="!entity.disambiguated.dbpedia" class="label label-info">{{entity.text}} ({{entity.type}}) {{entity.relevance | formatPercent}}%</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div ng-if="controller.data.summary.audio.analysis.concepts">
        <h2>Concepts</h3>
        <div class="well">
          <ul class="entry-taglist">
            <li ng-repeat="concept in controller.data.summary.audio.analysis.concepts" class="entry-tag">
              <span class="label label-info"><a href="{{concept.dbpedia}}">{{concept.text}} {{concept.relevance | formatPercent}}% <i class="fa fa-external-link"></i></a></span>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div ng-if="controller.data.summary.audio.analysis.docEmotions">
        <h2>Emotion Analysis</h2>
        <div class="well">
          <ul class="entry-taglist">
            <li ng-repeat="(key, value) in controller.data.summary.audio.analysis.docEmotions" class="entry-tag">
              <span class="label label-info">{{key}} {{value | formatPercent}}%</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div ng-if="controller.data.summary.audio.transcript">
        <h2>
          Transcript <span class="small text-muted">(first 15 minutes)</span>
          <button class="btn btn-primary btn-sm" type="button" data-toggle="collapse" data-target="#transcript" aria-expanded="false" aria-controls="transcript">show/hide</button>
        </h2>
        <div id="transcript" class="well collapse">
          <span class="transcript-sentence" ng-repeat="transcript in controller.data.summary.audio.transcript.results">
            {{transcript.alternatives[0].transcript | formatSentence}}.
          </span>
        </div>
      </div>
    </div>
  </div>

  <h2>{{controller.data.images.length}} Frames <span ng-if="controller.data.notProcessed>0" class="text-muted">({{controller.data.notProcessed}})</span></h2>
  <div>
    <ng-include ng-repeat="image in controller.data.images" src="'/partials/image.html'"></ng-include>
  </div>

</div>
<!--
//------------------------------------------------------------------------------
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//------------------------------------------------------------------------------
-->
